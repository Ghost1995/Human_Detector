<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Human Detection: Human_Detector</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Human Detection
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">DetectingHuman(Pedestrians)usingatrainedSVMandHOGfeatures.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Human_Detector </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/anirudhtopiwala/Human_Detector"></a> <a href="https://coveralls.io/github/anirudhtopiwala/Human_Detector?branch=master"></a> </p><h2><a href="https://opensource.org/licenses/MIT"></a> </h2>
<h2>Overview</h2>
<p>Human detection is an old and important problem in the field of object detection.Current technologies easily detect static obstacles. But, detecting dynamic obstacles has always been tough.In dynamic obstacles, human obstacles are the most important as any collision might lead to injury or loss of life which is highly undesirable for any product. This has generated a need for an accurate detector for making the algorithms more robust and efficient.</p>
<p>To this extent we propose an algorithm that can detect humans in a frame by making rectangular bounding boxes around individual humans. The center position of the rectangle will be used as the pixel location in that frame. The pixel coordinates can then be used with a robots intrinsic and extrinsic transformations to track the human with respect to the robot's world frame. We have used Histogram of Oriented Gradient (HOG) as the feature extractor. Support Vector Machine (SVM) is used to train using these feature vectors generated on the training data.The data set used for this project is taken from <a href="http://pascal.inrialpes.fr/data/human/">INRIA Person Dataset</a>. The algorithm is based on the paper by <a href="https://ieeexplore.ieee.org/document/1467360">Dalal, N. Triggs, B.</a>. A brief introduction of the algorithm can be found <a href="https://www.learnopencv.com/histogram-of-oriented-gradients/">here</a>.</p>
<h2>Algorithm and Outputs</h2>
<p>The goal of this project is to detect humans using a SVM classifier trained on Hog descriptors. As the name suggests there are three major componenets or classes in the project. The <b>Data class</b>, which is responsible for loading the training Data, the <b>Train class</b> which computes the Hog descriptors and trains the classifier and the <b>Detect class</b> which makes a bounding box around the detected human. Refer to the <a href="https://github.com/anirudhtopiwala/Human_Detector/blob/master/UML/revised/UML_Class.pdf">class</a> and the <a href="https://github.com/anirudhtopiwala/Human_Detector/blob/master/UML/initial/UML_Activity.pdf">activity</a> diagrams to understand the flow of the algorithm.</p>
<p>The algorithm starts with reading the positive(pos) images from the INRIA database to form the training data. Now as the HOG discriptors requires a cropped input of the human to form a good descriptor, the training images were cropped using the bounding boxes obtained from the annotations file. To have a balanced descriptor the negatives (neg) were formed by random cropping on the images obtained from the neg folder of the INRIA dataset. All the images along with the test images were finally resized to have the same size, as this is very essential to the proper working of the classifier.</p>
<p>The Hog features were calculated with a cell size of (4,4). This size was taken as the length of the descriptor is very high for a cell size of (2,2) and for a cell size of (8,8) the number of discriptors were not enough to respresent all the information of the image. This can be clearly observed in the comparison seen below.</p>
<div class="image">
<img src="https://github.com/anirudhtopiwala/Human_Detector/blob/master/additional_files/Hog_cell_size_comaprison.png" />
</div>
 <p>The Hog features for a cell size of (4,4) for some of the test images is shown below.</p>
<div class="image">
<img src="https://github.com/anirudhtopiwala/Human_Detector/blob/master/additional_files/hog.gif" />
</div>
 <p>Once the discriptor for pos and neg images is concatenated it is passed to the SVM classifier. After the classifier is trained the detectMultiScale function of opencv is used to make the detection. The bounding box obtained is then adjusted to give the final prediction of the human. Some of the detections on the test images can be seen below.</p>
<div class="image">
<img src="https://github.com/anirudhtopiwala/Human_Detector/blob/master/additional_files/detections.gif" />
</div>
 <p>As we can see the classifier is able to make an approximate detection of the human. This detection is the most basic kind of detection and many other optimization algorithms can be used to improve upon the detection accuracy. One way of removing multiple detections or multiple bounding boxes over a single human can be acieved by using <a href="https://www.pyimagesearch.com/2015/02/16/faster-non-maximum-suppression-python/">Non maximum suppression.</a>. Some other optimization techniques are discussed <a href="https://stackoverflow.com/questions/26607418/improving-accuracy-opencv-hog-people-detector">here</a>.</p>
<h2>License</h2>
<p>MIT License</p>
<p>Copyright (c) 2018 Anirudh Topiwala</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Permission is hereby granted, free of charge, to any person obtaining a copy</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;of this software and associated documentation files (the &quot;Software&quot;), to deal</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;in the Software without restriction, including without limitation the rights</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;copies of the Software, and to permit persons to whom the Software is</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;furnished to do so, subject to the following conditions:</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;The above copyright notice and this permission notice shall be included in all</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;copies or substantial portions of the Software.</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;SOFTWARE.</div></div><!-- fragment --><h2>TDD Process (check)</h2>
<p>Test Driven Development is used to develop the module. The process is detailed in the following <a href="https://docs.google.com/spreadsheets/d/1EZE9dxY_vlz4glKEceYtc5kQ3OyYQjs5Zh9BSKF8AoA/edit?usp=sharing">link</a></p>
<h2>Dependencies</h2>
<p>Install OpenCV 3.3.0 using the following commands</p>
<p>Install Dependencies </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install build-essential checkinstall cmake pkg-config yasm gfortran git</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;sudo apt-get install libjpeg8-dev libjasper-dev libpng12-dev</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;## If you are using Ubuntu 14.04</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;sudo apt-get install libtiff4-dev</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;## If you are using Ubuntu 16.04</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;sudo apt-get install libtiff5-dev</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;sudo apt-get install libavcodec-dev libavformat-dev libswscale-dev libdc1394-22-dev</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;sudo apt-get install libxine2-dev libv4l-dev</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;sudo apt-get install libgstreamer0.10-dev libgstreamer-plugins-base0.10-dev</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;sudo apt-get install libqt4-dev libgtk2.0-dev libtbb-dev</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;sudo apt-get install libatlas-base-dev</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;sudo apt-get install libfaac-dev libmp3lame-dev libtheora-dev</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;sudo apt-get install libvorbis-dev libxvidcore-dev</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;sudo apt-get install libopencore-amrnb-dev libopencore-amrwb-dev</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;sudo apt-get install x264 v4l-utils</div></div><!-- fragment --><p> Download and Compile OpenCV </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;git clone https://github.com/opencv/opencv.git</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd opencv </div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;git checkout 3.3.0 </div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;cd ..</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;git clone https://github.com/opencv/opencv_contrib.git</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;cd opencv_contrib</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;git checkout 3.3.0</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;cd ..</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;cd opencv</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;mkdir build</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;cd build</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;cmake -D CMAKE_BUILD_TYPE=RELEASE \</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;      -D CMAKE_INSTALL_PREFIX=/usr/local \</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;      -D INSTALL_C_EXAMPLES=ON \</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;      -D WITH_TBB=ON \</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;      -D WITH_V4L=ON \</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      -D WITH_QT=ON \</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;      -D OPENCV_EXTRA_MODULES_PATH=../../opencv_contrib/modules \</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;      -D BUILD_EXAMPLES=ON ..</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;## find out number of CPU cores in your machine</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;nproc</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;## substitute 4 by output of nproc</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;make -j4</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;sudo make install</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;sudo sh -c &#39;echo &quot;/usr/local/lib&quot; &gt;&gt; /etc/ld.so.conf.d/opencv.conf&#39;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;sudo ldconfig</div></div><!-- fragment --><p>## Build Instructions </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;git clone https://github.com/anirudhtopiwala/Human_Detector.git</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd Human_Detector</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;mkdir build</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;cd build</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;cmake ..</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;make</div></div><!-- fragment --> <h2>Data Set up</h2>
<p>The user has three options here: 1) Download our classifier from [here]() and save it in <a href="https://github.com/anirudhtopiwala/Human_Detector/tree/master/data/classifier/">./data/classifier/</a>. 2) Use a deafut Pre Trained classifier of OpenCv to run the program. 3) Train your own classifier to run the program.</p>
<p>For options 1 and 2 the user can either use his own data and give the file path for the test images in app/main.cpp or download the INRIA Dataset by running the code below. The dataset has both training and testing images and is of 1.9 GB. There are a couple of sample images present in <a href="https://github.com/anirudhtopiwala/Human_Detector/tree/master/data/test/pos">./data/test/pos/</a> which can also be used to test the classifier. In this case no additional image data needs to be downloaded. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd .. </div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd data</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;wget ftp://ftp.inrialpes.fr/pub/lear/douze/data/INRIAPerson.tar</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;cd ..</div></div><!-- fragment --><p> Downlading the INRIA dataset is necessary for option 3 as it will taking the training images from here. A different dataset can also be used here if needed but the feature extraction paramters and the classifier parmaters needs to be fine tuned accordingly.</p>
<h2>Running the Demo</h2>
<p>Go to the build directory and run the following command from the build directory:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd &lt;build folder of the module&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;./app/detectHumans </div></div><!-- fragment --><h2>Running Unit Tests</h2>
<p>Go to the build directory and run the following command from the build directory: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd &lt;build folder of the module&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;./test/detectHuman-test </div></div><!-- fragment --> <h2>How to generate doxygen documnetation</h2>
<p>To install doxygen run the following command: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;sudo apt-get install doxygen</div></div><!-- fragment --><p> Now from the cloned directory run: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;doxygen Doxygen</div></div><!-- fragment --><p> Doxygen files will be generated to /docs folder</p>
<p>To view them in a browser: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd docs</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd html</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;google-chrome index.html</div></div><!-- fragment --> <h2>Plugins</h2>
<p>CppChEclipse To install and run cppcheck in Terminal </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd &lt;path to repository&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cppcheck --enable=all --std=c++11 -I include/ --suppress=missingIncludeSystem $( find . -name \*.hpp -or -name \*.cpp | grep -vE -e &quot;^./build/&quot; -e &quot;^./vendor/&quot;  -e &quot;^./docs/&quot;  -e &quot;^./results/&quot; )</div></div><!-- fragment --><p> Google C++ Sytle To include and use Google C++ Style formatter in Terminal </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;cd &lt;path to repository&gt;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cpplint $( find . -name \*.hpp -or -name \*.cpp | grep -vE -e &quot;^./build/&quot; -e &quot;^./vendor/&quot; -e &quot;^./docs/&quot; -e &quot;^./results&quot; )</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
